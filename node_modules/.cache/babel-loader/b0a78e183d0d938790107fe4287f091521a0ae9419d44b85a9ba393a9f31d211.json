{"ast":null,"code":"import http from 'axios';\nimport { storage } from '../vuefire/firebase';\nimport { uploadBytes, getDownloadURL, ref } from 'firebase/storage';\nimport { bus } from '@/event-bus.js';\nexport default {\n  name: 'ModalVue',\n  props: {\n    user: {\n      type: String,\n      required: true\n    },\n    idPerfil: {\n      type: Number,\n      required: true\n    }\n  },\n  data() {\n    return {\n      imagen: null,\n      imgBanner: null,\n      nombre: ''\n    };\n  },\n  mounted() {},\n  methods: {\n    clickImagen(e) {\n      this.imagen = e.target.files[0];\n    },\n    clickBanner(e) {\n      this.imgBanner = e.target.files[0];\n    },\n    publicar() {\n      if (this.nombre.length === 0 | this.imgBanner.length === 0 | this.imagen.length === 0) {\n        const errmsg = 'Porfavor rellene todos los campos antes de guardar cambios';\n        bus.emit('actualizarPublicaciones', errmsg);\n      }\n      const imgRef = ref(storage, `perfil/${this.user}/${this.imagen.name}`);\n      uploadBytes(imgRef, this.imagen).then(e => console.log(e));\n      const bannerRef = ref(storage, `perfil/${this.user}/${this.imgBanner.name}`);\n      uploadBytes(bannerRef, this.imgBanner).then(e => console.log(e));\n      return http.post(`http://143.47.50.240:80/APIdotshare/perfilupdate/${this.idPerfil}`, {\n        nombre: this.nombre,\n        img: `${this.imagen.name}`,\n        imgBanner: `${this.imgBanner.name}`\n      }).then(response => response.data).then(response => console.log(response)).then(location.reload()).catch(err => console.log(err));\n    },\n    getImagen() {\n      const imgRef = ref(storage, 'images/laura/c2.png');\n      getDownloadURL(imgRef).then(url => {\n        console.log('emit' + url);\n      }).catch(error => {\n        switch (error.code) {\n          case 'storage/object-not-found':\n            break;\n          case 'storage/unauthorized':\n            break;\n          case 'storage/canceled':\n            break;\n          case 'storage/unknown':\n            break;\n        }\n      });\n    },\n    close() {\n      this.$emit('cierraSetting', false);\n    }\n  }\n};","map":{"version":3,"names":["http","storage","uploadBytes","getDownloadURL","ref","bus","name","props","user","type","String","required","idPerfil","Number","data","imagen","imgBanner","nombre","mounted","methods","clickImagen","e","target","files","clickBanner","publicar","length","errmsg","emit","imgRef","then","console","log","bannerRef","post","img","response","location","reload","catch","err","getImagen","url","error","code","close","$emit"],"sources":["C:\\Users\\mario\\OneDrive\\Escritorio\\TFG-DOTSHARE\\TFG-DAM-mainn\\src\\views\\ModalSetting.vue"],"sourcesContent":["<template>\n  <div class=\"modal show\" tabindex=\"-1\" role=\"dialog\">\n    <div class=\"modal-dialog\" role=\"document\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h5 class=\"modal-title\">Settings</h5>\n          <button @click=\"close\" type=\"button\" class=\"close\" aria-label=\"Close\">\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n        </div>\n        <form @submit.prevent=\"publicar\" enctype=\"multipart/form-data\">\n          <div class=\"modal-body\">\n            <div class=\"form__input\">\n              <p>Nombre: </p>\n              <input type=\"text\" v-model=\"nombre\" name=\"nombre\" />\n            </div>\n            <div class=\"form__input-file\">\n              <p>Imagen Perfil: </p>\n              <input @change=\"clickImagen($event)\" type=\"file\" accept=\"application/msword, application/vnd.ms-excel, application/vnd.ms-powerpoint,text/plain, application/pdf, image/*\" />\n            </div>\n            <div class=\"form__input-file\">\n              <p>Banner: </p>\n              <input @change=\"clickBanner($event)\" type=\"file\" accept=\"application/msword, application/vnd.ms-excel, application/vnd.ms-powerpoint,text/plain, application/pdf, image/*\" />\n            </div>\n          </div>\n          <div class=\"modal-footer\">\n            <input type=\"submit\" class=\"btn btn-primary\" value=\"Save Changes\"/>\n            <button @click=\"close\" type=\"button\" class=\"btn btn-secondary\">Close</button>\n          </div>\n        </form>\n      </div>\n  </div>\n</div>\n</template>\n\n<script>\nimport http from 'axios'\nimport { storage } from '../vuefire/firebase'\nimport { uploadBytes, getDownloadURL, ref } from 'firebase/storage'\nimport { bus } from '@/event-bus.js'\n\nexport default {\n  name: 'ModalVue',\n  props: {\n    user: {\n      type: String,\n      required: true\n    },\n    idPerfil: {\n      type: Number,\n      required: true\n    }\n  },\n  data () {\n    return {\n      imagen: null,\n      imgBanner: null,\n      nombre: ''\n    }\n  },\n  mounted () {\n  },\n  methods: {\n    clickImagen (e) {\n      this.imagen = e.target.files[0]\n    },\n    clickBanner (e) {\n      this.imgBanner = e.target.files[0]\n    },\n    publicar () {\n      if ((this.nombre.length === 0) | (this.imgBanner.length === 0) | (this.imagen.length === 0)) {\n        const errmsg = 'Porfavor rellene todos los campos antes de guardar cambios'\n        bus.emit('actualizarPublicaciones', errmsg)\n      }\n      const imgRef = ref(storage, `perfil/${this.user}/${this.imagen.name}`)\n      uploadBytes(imgRef, this.imagen)\n        .then(e => console.log(e))\n      const bannerRef = ref(storage, `perfil/${this.user}/${this.imgBanner.name}`)\n      uploadBytes(bannerRef, this.imgBanner)\n        .then(e => console.log(e))\n      return http.post(\n        `http://143.47.50.240:80/APIdotshare/perfilupdate/${this.idPerfil}`,\n        {\n          nombre: this.nombre,\n          img: `${this.imagen.name}`,\n          imgBanner: `${this.imgBanner.name}`\n        }\n      )\n        .then((response) => response.data)\n        .then(response => console.log(response))\n        .then(location.reload())\n        .catch((err) => console.log(err))\n    },\n    getImagen () {\n      const imgRef = ref(storage, 'images/laura/c2.png')\n      getDownloadURL(imgRef)\n        .then((url) => {\n          console.log('emit' + url)\n        })\n        .catch((error) => {\n          switch (error.code) {\n            case 'storage/object-not-found':\n              break\n            case 'storage/unauthorized':\n              break\n            case 'storage/canceled':\n              break\n            case 'storage/unknown':\n              break\n          }\n        })\n    },\n    close () {\n      this.$emit('cierraSetting', false)\n    }\n  }\n}\n</script>\n\n<style scoped>\n.show{\n  display: block;\n}\n.form-select{\n  margin: 0 0 1em 0;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}