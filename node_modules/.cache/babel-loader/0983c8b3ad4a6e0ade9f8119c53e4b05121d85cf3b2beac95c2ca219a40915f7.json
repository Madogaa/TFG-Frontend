{"ast":null,"code":"import { bus } from '@/event-bus.js';\nimport axios from 'axios';\nimport { storage } from '@/vuefire/firebase';\nimport { ref, getDownloadURL } from '@firebase/storage';\nimport { saveAs } from 'file-saver';\nexport default {\n  name: 'MyPublicacion',\n  props: {\n    idpub: {\n      type: Number\n    },\n    desc: {\n      type: String,\n      required: true\n    },\n    archivos: {\n      type: Array\n    },\n    profile: {\n      type: String\n    }\n  },\n  methods: {\n    emitEvento() {\n      axios({\n        method: 'GET',\n        url: `http://localhost:8080/APIdotshare/archivo/borrar/${this.idpub}`\n      }).then(response => response.data).then(data => {\n        console.log('Archivos:' + data);\n        axios({\n          method: 'GET',\n          url: `http://localhost:8080/APIdotshare/publicaciones/borrar/${this.idpub}`\n        }).then(response => {\n          console.log('Publicacion borrada con exito');\n          bus.emit('actualizarPublicaciones', false);\n        });\n      });\n    },\n    downloadFile(info) {\n      console.log(info);\n      const storageRef = ref(storage, `publicacion/${this.profile}/${info.dir}`);\n      console.log('Archivo:' + storageRef);\n      getDownloadURL(storageRef).then(url => {\n        var xhr = new XMLHttpRequest();\n        xhr.responseType = 'blob';\n        xhr.onload = function (event) {\n          var blob = xhr.response;\n          saveAs(blob, info.dir);\n        };\n        xhr.open('GET', url);\n        xhr.send();\n      });\n    }\n  }\n};","map":{"version":3,"names":["bus","axios","storage","ref","getDownloadURL","saveAs","name","props","idpub","type","Number","desc","String","required","archivos","Array","profile","methods","emitEvento","method","url","then","response","data","console","log","emit","downloadFile","info","storageRef","dir","xhr","XMLHttpRequest","responseType","onload","event","blob","open","send"],"sources":["C:\\Users\\mario\\OneDrive\\Escritorio\\TFG-DOTSHARE\\TFG-DAM-mainn\\src\\views\\Publicacion.vue"],"sourcesContent":["<template>\n    <div class=\"publicacion\">\n      <div class=\"header\">\n        <div class=\"delete\">\n          <img src=\"../assets/borrar.png\" @click=\"emitEvento()\" alt=\"\">\n        </div>\n      </div>\n      <p class=\"desc\">\n        {{ desc }}\n      </p>\n      <div v-for=\"archivo in this.archivos\" v-bind:key=\"archivo.idArchivo\" @click=\"downloadFile(archivo)\" class=\"file\">\n        <p>{{ archivo.dir }}</p>\n      </div>\n    </div>\n</template>\n\n<script>\nimport { bus } from '@/event-bus.js'\nimport axios from 'axios'\nimport { storage } from '@/vuefire/firebase'\nimport { ref, getDownloadURL } from '@firebase/storage'\nimport { saveAs } from 'file-saver'\n\nexport default {\n  name: 'MyPublicacion',\n  props: {\n    idpub: {\n      type: Number\n    },\n    desc: {\n      type: String,\n      required: true\n    },\n    archivos: {\n      type: Array\n    },\n    profile: {\n      type: String\n    }\n  },\n  methods: {\n    emitEvento () {\n      axios(\n        {\n          method: 'GET',\n          url: `http://localhost:8080/APIdotshare/archivo/borrar/${this.idpub}`\n        }\n      ).then((response) => response.data)\n        .then(data => {\n          console.log('Archivos:' + data)\n          axios(\n            {\n              method: 'GET',\n              url: `http://localhost:8080/APIdotshare/publicaciones/borrar/${this.idpub}`\n            }\n          ).then(response => {\n            console.log('Publicacion borrada con exito')\n            bus.emit('actualizarPublicaciones', false)\n          })\n        })\n    },\n    downloadFile (info) {\n      console.log(info)\n      const storageRef = ref(storage, `publicacion/${this.profile}/${info.dir}`)\n      console.log('Archivo:' + storageRef)\n      getDownloadURL(storageRef)\n        .then(url => {\n          var xhr = new XMLHttpRequest()\n          xhr.responseType = 'blob'\n          xhr.onload = function (event) {\n            var blob = xhr.response\n            saveAs(blob, info.dir)\n          }\n          xhr.open('GET', url)\n          xhr.send()\n        })\n    }\n  }\n}\n</script>\n\n<style scoped>\na{\n  text-decoration: none;\n  color: black;\n}\np{\n  margin: 0;\n}\n.delete img{\n  padding: 0.5em;\n  cursor: pointer;\n}\n\n.publicacion{\n  position: relative;\n  background: linear-gradient(60deg,rgba(255,255,255,0.13),rgba(52, 72, 94, 0.6));\n  border: solid 1px rgba(255, 255, 255, 0.2);\n  border-radius: 0.5em;\n  box-shadow: 0 0 1em rgba(255, 255, 255, 0.13);\n  margin: 25px 0;\n  color: white;\n  padding: 2em;\n  text-align: left;\n}\n.desc {\n  padding: 0.5em;\n}\n\n.file{\n  width: fit-content;\n  padding: 0 1em 0 2em;\n  position: relative;\n  border: solid 1px rgba(255, 255, 255, 0.2);\n  border-radius: 1em;\n  max-width: 150px;\n  margin: 0.5em;\n  cursor: pointer;\n}\n\n.file p{\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.file::before{\n  content:\"\";\n  position: absolute;\n  background: greenyellow;\n  height: 0.5em;\n  width: 0.5em;\n  left: 1em;\n  bottom: 0.5em;\n  border-radius: 50%;\n}\n\n.header{\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 20%;\n  width: 100%;\n  background-color: aliceblue;\n  border-radius: 0.5em 0.5em 0 0;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n}\n</style>\n"],"mappings":"AAiBA,SAASA,GAAE,QAAS,gBAAe;AACnC,OAAOC,KAAI,MAAO,OAAM;AACxB,SAASC,OAAM,QAAS,oBAAmB;AAC3C,SAASC,GAAG,EAAEC,cAAa,QAAS,mBAAkB;AACtD,SAASC,MAAK,QAAS,YAAW;AAElC,eAAe;EACbC,IAAI,EAAE,eAAe;EACrBC,KAAK,EAAE;IACLC,KAAK,EAAE;MACLC,IAAI,EAAEC;IACR,CAAC;IACDC,IAAI,EAAE;MACJF,IAAI,EAAEG,MAAM;MACZC,QAAQ,EAAE;IACZ,CAAC;IACDC,QAAQ,EAAE;MACRL,IAAI,EAAEM;IACR,CAAC;IACDC,OAAO,EAAE;MACPP,IAAI,EAAEG;IACR;EACF,CAAC;EACDK,OAAO,EAAE;IACPC,UAASA,CAAA,EAAK;MACZjB,KAAK,CACH;QACEkB,MAAM,EAAE,KAAK;QACbC,GAAG,EAAG,oDAAmD,IAAI,CAACZ,KAAM;MACtE,EACD,CAACa,IAAI,CAAEC,QAAQ,IAAKA,QAAQ,CAACC,IAAI,EAC/BF,IAAI,CAACE,IAAG,IAAK;QACZC,OAAO,CAACC,GAAG,CAAC,WAAU,GAAIF,IAAI;QAC9BtB,KAAK,CACH;UACEkB,MAAM,EAAE,KAAK;UACbC,GAAG,EAAG,0DAAyD,IAAI,CAACZ,KAAM;QAC5E,EACD,CAACa,IAAI,CAACC,QAAO,IAAK;UACjBE,OAAO,CAACC,GAAG,CAAC,+BAA+B;UAC3CzB,GAAG,CAAC0B,IAAI,CAAC,yBAAyB,EAAE,KAAK;QAC3C,CAAC;MACH,CAAC;IACL,CAAC;IACDC,YAAWA,CAAGC,IAAI,EAAE;MAClBJ,OAAO,CAACC,GAAG,CAACG,IAAI;MAChB,MAAMC,UAAS,GAAI1B,GAAG,CAACD,OAAO,EAAG,eAAc,IAAI,CAACc,OAAQ,IAAGY,IAAI,CAACE,GAAI,EAAC;MACzEN,OAAO,CAACC,GAAG,CAAC,UAAS,GAAII,UAAU;MACnCzB,cAAc,CAACyB,UAAU,EACtBR,IAAI,CAACD,GAAE,IAAK;QACX,IAAIW,GAAE,GAAI,IAAIC,cAAc,EAAC;QAC7BD,GAAG,CAACE,YAAW,GAAI,MAAK;QACxBF,GAAG,CAACG,MAAK,GAAI,UAAUC,KAAK,EAAE;UAC5B,IAAIC,IAAG,GAAIL,GAAG,CAACT,QAAO;UACtBjB,MAAM,CAAC+B,IAAI,EAAER,IAAI,CAACE,GAAG;QACvB;QACAC,GAAG,CAACM,IAAI,CAAC,KAAK,EAAEjB,GAAG;QACnBW,GAAG,CAACO,IAAI,EAAC;MACX,CAAC;IACL;EACF;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}